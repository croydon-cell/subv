(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[196],{32446:function(e,t,s){Promise.resolve().then(s.bind(s,50073))},50073:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return T}});var a=s(57437),r=s(2265),l=s(94411),n=s(10273),i=s(56360),c=s(79004),d=s(78149),o=s(1584),u=s(98324),m=s(91715),x=s(1336),h=s(25171),p="Switch",[f,b]=(0,u.b)(p),[j,v]=f(p),g=r.forwardRef((e,t)=>{let{__scopeSwitch:s,name:l,checked:n,defaultChecked:i,required:c,disabled:u,value:x="on",onCheckedChange:f,form:b,...v}=e,[g,N]=r.useState(null),y=(0,o.e)(t,e=>N(e)),Z=r.useRef(!1),S=!g||b||!!g.closest("form"),[_,C]=(0,m.T)({prop:n,defaultProp:null!=i&&i,onChange:f,caller:p});return(0,a.jsxs)(j,{scope:s,checked:_,disabled:u,children:[(0,a.jsx)(h.WV.button,{type:"button",role:"switch","aria-checked":_,"aria-required":c,"data-state":k(_),"data-disabled":u?"":void 0,disabled:u,value:x,...v,ref:y,onClick:(0,d.M)(e.onClick,e=>{C(e=>!e),S&&(Z.current=e.isPropagationStopped(),Z.current||e.stopPropagation())})}),S&&(0,a.jsx)(w,{control:g,bubbles:!Z.current,name:l,value:x,checked:_,required:c,disabled:u,form:b,style:{transform:"translateX(-100%)"}})]})});g.displayName=p;var N="SwitchThumb",y=r.forwardRef((e,t)=>{let{__scopeSwitch:s,...r}=e,l=v(N,s);return(0,a.jsx)(h.WV.span,{"data-state":k(l.checked),"data-disabled":l.disabled?"":void 0,...r,ref:t})});y.displayName=N;var w=r.forwardRef((e,t)=>{let{__scopeSwitch:s,control:l,checked:n,bubbles:i=!0,...c}=e,d=r.useRef(null),u=(0,o.e)(d,t),m=function(e){let t=r.useRef({value:e,previous:e});return r.useMemo(()=>(t.current.value!==e&&(t.current.previous=t.current.value,t.current.value=e),t.current.previous),[e])}(n),h=function(e){let[t,s]=r.useState(void 0);return(0,x.b)(()=>{if(e){s({width:e.offsetWidth,height:e.offsetHeight});let t=new ResizeObserver(t=>{let a,r;if(!Array.isArray(t)||!t.length)return;let l=t[0];if("borderBoxSize"in l){let e=l.borderBoxSize,t=Array.isArray(e)?e[0]:e;a=t.inlineSize,r=t.blockSize}else a=e.offsetWidth,r=e.offsetHeight;s({width:a,height:r})});return t.observe(e,{box:"border-box"}),()=>t.unobserve(e)}s(void 0)},[e]),t}(l);return r.useEffect(()=>{let e=d.current;if(!e)return;let t=Object.getOwnPropertyDescriptor(window.HTMLInputElement.prototype,"checked").set;if(m!==n&&t){let s=new Event("click",{bubbles:i});t.call(e,n),e.dispatchEvent(s)}},[m,n,i]),(0,a.jsx)("input",{type:"checkbox","aria-hidden":!0,defaultChecked:n,...c,tabIndex:-1,ref:u,style:{...c.style,...h,position:"absolute",pointerEvents:"none",opacity:0,margin:0}})});function k(e){return e?"checked":"unchecked"}w.displayName="SwitchBubbleInput";var Z=s(77700);let S=r.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,a.jsx)(g,{className:(0,Z.cn)("peer inline-flex h-5 w-9 shrink-0 cursor-pointer items-center rounded-full border-2 border-transparent shadow-sm transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 focus-visible:ring-offset-background disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=unchecked]:bg-input",s),...r,ref:t,children:(0,a.jsx)(y,{className:(0,Z.cn)("pointer-events-none block h-4 w-4 rounded-full bg-background shadow-lg ring-0 transition-transform data-[state=checked]:translate-x-4 data-[state=unchecked]:translate-x-0")})})});S.displayName=g.displayName;var _=s(17953),C=s(11980),R=s(66706),A=s(36127),E=s(92940),P=s(51077),D=s(56935),z=s(71935),I=s(55430),M=s(6600);let O=(0,s(78030).Z)("info",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 16v-4",key:"1dtifu"}],["path",{d:"M12 8h.01",key:"e9boi3"}]]);function T(){var e,t,s,d;let[o,u]=(0,r.useState)(null),[m,x]=(0,r.useState)([]),[h,p]=(0,r.useState)([]),[f,b]=(0,r.useState)(!0),[j,v]=(0,r.useState)(!1);(0,r.useEffect)(()=>{g()},[]);let g=async()=>{b(!0);try{let[e,t,s]=await Promise.all([fetch("/api/customer/profile"),fetch("/api/customer/payments"),fetch("/api/customer/reminders")]),[a,r,l]=await Promise.all([e.json(),t.json(),s.json()]);u(a.data),x(r.data),p(l.data),v(a.data.auto_pay_enabled)}catch(e){console.error("Error fetching dashboard data:",e)}finally{b(!1)}},N=async()=>{try{let e=await fetch("/api/customer/toggle-autopay",{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify({enabled:!j})}),t=await e.json();t.success&&(v(!j),alert(t.message))}catch(e){console.error("Error toggling AutoPay:",e)}},y=async()=>{try{let e=await fetch("/api/customer/make-payment",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({amount:o.amount_due})}),t=await e.json();t.success&&(alert("Payment initiated! Redirecting to payment gateway..."),console.log("Payment Link:",t.data.payment_link))}catch(e){console.error("Error making payment:",e)}},w=e=>new Intl.NumberFormat("en-IN",{style:"currency",currency:"INR",maximumFractionDigits:0}).format(e);if(f)return(0,a.jsx)(l.c,{currentRole:"customer",children:(0,a.jsx)("div",{className:"flex items-center justify-center h-screen",children:(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsx)(R.Z,{className:"h-8 w-8 animate-spin mx-auto mb-4 text-blue-600"}),(0,a.jsx)("p",{className:"text-slate-600",children:"Loading your dashboard..."})]})})});let k=(null==o?void 0:o.days_remaining)||0,Z=k<0;return(0,a.jsx)(l.c,{currentRole:"customer",children:(0,a.jsxs)("div",{className:"p-8 space-y-8 max-w-6xl mx-auto",children:[(0,a.jsxs)("div",{children:[(0,a.jsxs)("h1",{className:"text-4xl font-bold bg-gradient-to-r from-blue-600 to-indigo-600 bg-clip-text text-transparent",children:["Welcome back, ",null==o?void 0:o.name,"!"]}),(0,a.jsx)("p",{className:"text-slate-600 mt-2",children:"Manage your subscription and payments"})]}),(k<=7&&k>0||Z)&&(0,a.jsxs)(C.bZ,{variant:Z?"destructive":"warning",children:[(0,a.jsx)(A.Z,{className:"h-4 w-4"}),(0,a.jsx)(C.X,{children:Z?"Your subscription expired ".concat(Math.abs(k)," days ago. Renew now to continue enjoying your service."):"Your subscription expires in ".concat(k," days. Renew now to avoid service interruption.")})]}),(0,a.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-8",children:[(0,a.jsxs)("div",{className:"lg:col-span-2 space-y-6",children:[(0,a.jsx)(n.Zb,{className:"border-0 shadow-xl bg-gradient-to-br from-blue-600 via-indigo-600 to-purple-600 text-white",children:(0,a.jsxs)(n.aY,{className:"pt-6",children:[(0,a.jsxs)("div",{className:"flex items-start justify-between mb-6",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-white/80 text-sm mb-1",children:"Current Plan"}),(0,a.jsx)("h2",{className:"text-3xl font-bold",children:null==o?void 0:null===(e=o.plan)||void 0===e?void 0:e.name}),(0,a.jsx)("p",{className:"text-white/80 mt-1",children:null==o?void 0:o.subscriber_id})]}),(0,a.jsx)(c.C,{className:"bg-white text-blue-600 font-semibold",children:(null==o?void 0:o.status)==="active"?"ACTIVE":"EXPIRED"})]}),(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-6 mb-6",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-white/80 text-sm mb-1",children:"Monthly Amount"}),(0,a.jsx)("p",{className:"text-2xl font-bold",children:w((null==o?void 0:null===(t=o.plan)||void 0===t?void 0:t.amount)||0)})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-white/80 text-sm mb-1",children:"Next Billing"}),(0,a.jsx)("p",{className:"text-lg font-semibold",children:(null==o?void 0:o.next_billing_date)?new Date(o.next_billing_date).toLocaleDateString():"N/A"})]})]}),(0,a.jsxs)("div",{className:"p-4 rounded-lg bg-white/10 backdrop-blur-sm",children:[(0,a.jsx)("p",{className:"text-white/80 text-sm mb-2",children:"Plan Features"}),(0,a.jsx)("div",{className:"grid grid-cols-2 gap-2",children:null==o?void 0:null===(d=o.plan)||void 0===d?void 0:null===(s=d.features)||void 0===s?void 0:s.map((e,t)=>(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,a.jsx)(E.Z,{className:"h-4 w-4 text-green-400"}),(0,a.jsx)("span",{className:"text-sm",children:e})]},t))})]})]})}),(null==o?void 0:o.amount_due)>0&&(0,a.jsxs)(n.Zb,{className:"border-0 shadow-lg",children:[(0,a.jsx)(n.Ol,{children:(0,a.jsxs)(n.ll,{className:"flex items-center",children:[(0,a.jsx)(P.Z,{className:"h-5 w-5 mr-2 text-blue-600"}),"Payment Due"]})}),(0,a.jsx)(n.aY,{children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-3xl font-bold text-blue-600",children:w(o.amount_due)}),(0,a.jsxs)("p",{className:"text-sm text-slate-600 mt-1",children:["Due by ",(null==o?void 0:o.expiry_date)?new Date(o.expiry_date).toLocaleDateString():"N/A"]})]}),(0,a.jsxs)(i.z,{size:"lg",className:"bg-gradient-to-r from-blue-600 to-indigo-600",onClick:y,children:[(0,a.jsx)(D.Z,{className:"h-5 w-5 mr-2"}),"Pay Now"]})]})})]}),(0,a.jsxs)(n.Zb,{className:"border-0 shadow-lg",children:[(0,a.jsxs)(n.Ol,{children:[(0,a.jsx)(n.ll,{children:"Payment History"}),(0,a.jsx)(n.SZ,{children:"Your recent transactions"})]}),(0,a.jsx)(n.aY,{children:(0,a.jsx)("div",{className:"space-y-3",children:m.map(e=>(0,a.jsx)(n.Zb,{className:"border-l-4",style:{borderLeftColor:"success"===e.status?"#10b981":"#ef4444"},children:(0,a.jsx)(n.aY,{className:"pt-4",children:(0,a.jsxs)("div",{className:"flex items-start justify-between",children:[(0,a.jsxs)("div",{className:"flex-1",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-2 mb-1",children:[(0,a.jsx)("p",{className:"font-semibold",children:w(e.amount)}),(0,a.jsx)(c.C,{variant:"success"===e.status?"success":"destructive",children:e.status})]}),(0,a.jsx)("p",{className:"text-sm text-slate-600",children:e.description}),(0,a.jsxs)("p",{className:"text-xs text-slate-500 mt-1",children:[new Date(e.date).toLocaleDateString()," â€¢ ",e.method]}),e.transaction_id&&(0,a.jsxs)("p",{className:"text-xs text-slate-400 mt-1",children:["TXN: ",e.transaction_id]}),e.failure_reason&&(0,a.jsxs)("p",{className:"text-xs text-red-600 mt-1",children:["Reason: ",e.failure_reason]}),e.retry_status&&(0,a.jsx)("p",{className:"text-xs text-green-600 mt-1",children:e.retry_status})]}),"success"===e.status?(0,a.jsx)(E.Z,{className:"h-6 w-6 text-green-600"}):(0,a.jsx)(z.Z,{className:"h-6 w-6 text-red-600"})]})})},e.id))})})]})]}),(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsxs)(n.Zb,{className:"border-0 shadow-lg",children:[(0,a.jsx)(n.Ol,{children:(0,a.jsxs)(n.ll,{className:"flex items-center text-lg",children:[(0,a.jsx)(I.Z,{className:"h-5 w-5 mr-2 text-yellow-500"}),"AutoPay"]})}),(0,a.jsxs)(n.aY,{children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"font-medium",children:j?"Enabled":"Disabled"}),(0,a.jsx)("p",{className:"text-sm text-slate-600",children:j?"Automatic payments active":"Enable for hassle-free payments"})]}),(0,a.jsx)(S,{checked:j,onCheckedChange:N})]}),(0,a.jsx)(_.Z,{className:"my-4"}),(0,a.jsxs)("div",{className:"space-y-2 text-sm text-slate-600",children:[(0,a.jsxs)("div",{className:"flex items-start space-x-2",children:[(0,a.jsx)(E.Z,{className:"h-4 w-4 text-green-600 mt-0.5"}),(0,a.jsx)("span",{children:"Never miss a payment"})]}),(0,a.jsxs)("div",{className:"flex items-start space-x-2",children:[(0,a.jsx)(E.Z,{className:"h-4 w-4 text-green-600 mt-0.5"}),(0,a.jsx)("span",{children:"AI-powered retry on failures"})]}),(0,a.jsxs)("div",{className:"flex items-start space-x-2",children:[(0,a.jsx)(E.Z,{className:"h-4 w-4 text-green-600 mt-0.5"}),(0,a.jsx)("span",{children:"Secure UPI mandate"})]})]})]})]}),(0,a.jsxs)(n.Zb,{className:"border-0 shadow-lg",children:[(0,a.jsx)(n.Ol,{children:(0,a.jsxs)(n.ll,{className:"flex items-center text-lg",children:[(0,a.jsx)(M.Z,{className:"h-5 w-5 mr-2 text-blue-600"}),"Smart Reminders"]})}),(0,a.jsx)(n.aY,{children:(0,a.jsx)("div",{className:"space-y-3",children:h.map(e=>(0,a.jsxs)("div",{className:"p-3 rounded-lg bg-slate-50 border border-slate-200",children:[(0,a.jsxs)("div",{className:"flex items-start space-x-2 mb-1",children:[(0,a.jsx)(c.C,{variant:"sent"===e.status?"secondary":"pending"===e.status?"warning":"default",className:"text-xs",children:e.status}),(0,a.jsx)(c.C,{variant:"outline",className:"text-xs",children:e.channel})]}),(0,a.jsx)("p",{className:"text-sm text-slate-700 mt-2",children:e.message}),(0,a.jsx)("p",{className:"text-xs text-slate-500 mt-1",children:new Date(e.date).toLocaleDateString()})]},e.id))})})]}),(0,a.jsxs)(n.Zb,{className:"border-0 shadow-lg",children:[(0,a.jsx)(n.Ol,{children:(0,a.jsx)(n.ll,{className:"text-lg",children:"Account Information"})}),(0,a.jsxs)(n.aY,{className:"space-y-3 text-sm",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-slate-600",children:"Name"}),(0,a.jsx)("p",{className:"font-medium",children:null==o?void 0:o.name})]}),(0,a.jsx)(_.Z,{}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-slate-600",children:"Email"}),(0,a.jsx)("p",{className:"font-medium",children:null==o?void 0:o.email})]}),(0,a.jsx)(_.Z,{}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-slate-600",children:"Phone"}),(0,a.jsx)("p",{className:"font-medium",children:null==o?void 0:o.phone})]}),(0,a.jsx)(_.Z,{}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-slate-600",children:"Subscriber ID"}),(0,a.jsx)("p",{className:"font-medium font-mono text-xs",children:null==o?void 0:o.subscriber_id})]})]})]}),(0,a.jsx)(n.Zb,{className:"border-0 shadow-lg bg-gradient-to-br from-blue-50 to-indigo-50",children:(0,a.jsx)(n.aY,{className:"pt-6",children:(0,a.jsxs)("div",{className:"flex items-start space-x-3",children:[(0,a.jsx)(O,{className:"h-5 w-5 text-blue-600 mt-0.5"}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"font-semibold text-sm mb-1",children:"Need Help?"}),(0,a.jsx)("p",{className:"text-xs text-slate-600 mb-3",children:"Contact our support team for any queries or issues with your subscription."}),(0,a.jsx)(i.z,{size:"sm",variant:"outline",className:"w-full",children:"Contact Support"})]})]})})})]})]})]})})}},11980:function(e,t,s){"use strict";s.d(t,{Cd:function(){return d},X:function(){return o},bZ:function(){return c}});var a=s(57437),r=s(2265),l=s(13027),n=s(77700);let i=(0,l.j)("relative w-full rounded-lg border px-4 py-3 text-sm [&>svg+div]:translate-y-[-3px] [&>svg]:absolute [&>svg]:left-4 [&>svg]:top-4 [&>svg]:text-foreground [&>svg~*]:pl-7",{variants:{variant:{default:"bg-background text-foreground",destructive:"border-destructive/50 text-destructive dark:border-destructive [&>svg]:text-destructive"}},defaultVariants:{variant:"default"}}),c=r.forwardRef((e,t)=>{let{className:s,variant:r,...l}=e;return(0,a.jsx)("div",{ref:t,role:"alert",className:(0,n.cn)(i({variant:r}),s),...l})});c.displayName="Alert";let d=r.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,a.jsx)("h5",{ref:t,className:(0,n.cn)("mb-1 font-medium leading-none tracking-tight",s),...r})});d.displayName="AlertTitle";let o=r.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,a.jsx)("div",{ref:t,className:(0,n.cn)("text-sm [&_p]:leading-relaxed",s),...r})});o.displayName="AlertDescription"},6600:function(e,t,s){"use strict";s.d(t,{Z:function(){return a}});let a=(0,s(78030).Z)("bell",[["path",{d:"M10.268 21a2 2 0 0 0 3.464 0",key:"vwvbt9"}],["path",{d:"M3.262 15.326A1 1 0 0 0 4 17h16a1 1 0 0 0 .74-1.673C19.41 13.956 18 12.499 18 8A6 6 0 0 0 6 8c0 4.499-1.411 5.956-2.738 7.326",key:"11g9vi"}]])},92940:function(e,t,s){"use strict";s.d(t,{Z:function(){return a}});let a=(0,s(78030).Z)("circle-check-big",[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]])},71935:function(e,t,s){"use strict";s.d(t,{Z:function(){return a}});let a=(0,s(78030).Z)("circle-x",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]])},56935:function(e,t,s){"use strict";s.d(t,{Z:function(){return a}});let a=(0,s(78030).Z)("credit-card",[["rect",{width:"20",height:"14",x:"2",y:"5",rx:"2",key:"ynyp8z"}],["line",{x1:"2",x2:"22",y1:"10",y2:"10",key:"1b3vmo"}]])},36127:function(e,t,s){"use strict";s.d(t,{Z:function(){return a}});let a=(0,s(78030).Z)("triangle-alert",[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",key:"wmoenq"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]])},91715:function(e,t,s){"use strict";s.d(t,{T:function(){return i}});var a,r=s(2265),l=s(1336),n=(a||(a=s.t(r,2)))[" useInsertionEffect ".trim().toString()]||l.b;function i({prop:e,defaultProp:t,onChange:s=()=>{},caller:a}){let[l,i,c]=function({defaultProp:e,onChange:t}){let[s,a]=r.useState(e),l=r.useRef(s),i=r.useRef(t);return n(()=>{i.current=t},[t]),r.useEffect(()=>{l.current!==s&&(i.current?.(s),l.current=s)},[s,l]),[s,a,i]}({defaultProp:t,onChange:s}),d=void 0!==e,o=d?e:l;{let t=r.useRef(void 0!==e);r.useEffect(()=>{let e=t.current;if(e!==d){let t=d?"controlled":"uncontrolled";console.warn(`${a} is changing from ${e?"controlled":"uncontrolled"} to ${t}. Components should not switch from controlled to uncontrolled (or vice versa). Decide between using a controlled or uncontrolled value for the lifetime of the component.`)}t.current=d},[d,a])}return[o,r.useCallback(t=>{if(d){let s="function"==typeof t?t(e):t;s!==e&&c.current?.(s)}else i(t)},[d,e,i,c])]}Symbol("RADIX:SYNC_STATE")}},function(e){e.O(0,[419,77,821,971,23,744],function(){return e(e.s=32446)}),_N_E=e.O()}]);